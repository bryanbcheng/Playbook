(function(e){var t,n,r={palette:e('<div class="select-shape-palette"></div>'),circle:e('<div class="palette-item palette-circle"></div>'),square:e('<div class="palette-item palette-square"></div>'),triangle:e('<div class="palette-item palette-triangle"></div>'),x:e('<div class="palette-item palette-x"></div>')},i;e.fn.shapePicker=function(t){return this.each(function(){var n=e(this),i=n.attr("value")?n.attr("value"):e.fn.shapePicker.defaults.pickerDefault,s=r.palette.clone(),o=r.circle.clone(),u=r.square.clone(),a=r.triangle.clone(),f=r.x.clone();n.addClass("palette-"+i),n.val(i),s.append(o,u,a,f),n.append(s),n.on("mouseover",function(t){e.fn.shapePicker.showPalette(e(this).children(".select-shape-palette"),e(this))}),n.on("mouseout",function(t){e.fn.shapePicker.checkMouse(t)}),n.find(".palette-item").each(function(t,n){e.fn.shapePicker.bindPalette(e(n),e.fn.shapePicker.defaults.shapes[t])}),t&&t.onShapeChange?n.data("onShapeChange",t.onShapeChange):n.data("onShapeChange",function(){})})},e.extend(!0,e.fn.shapePicker,{checkMouse:function(t){if(t.relatedTarget===selectorOwner[0]||e(t.relatedTarget).parents(".select-shape").length>0)return;e.fn.shapePicker.hidePalette()},showPalette:function(e,t){selectorOwner=t,n=e,e.css({left:selectorOwner.position().left,top:selectorOwner.position().top+selectorOwner.outerHeight()}),e.fadeIn(350,"swing")},hidePalette:function(){e(".select-shape-palette").fadeOut(350,"swing")},changeShape:function(t){selectorOwner.attr("class","select-shape palette-"+t),selectorOwner.val(t),e.fn.shapePicker.hidePalette(),selectorOwner.data("onShapeChange").call(selectorOwner,e(selectorOwner).attr("id"),t)},previewShape:function(e){selectorOwner.attr("class","select-shape palette-"+e)},bindPalette:function(t,n){t.on({click:function(t){i=n,e.fn.shapePicker.changeShape(n),t.stopPropagation()},mouseover:function(t){i=selectorOwner.val(),e.fn.shapePicker.previewShape(n)},mouseout:function(t){e.fn.shapePicker.previewShape(i)}})}}),e.fn.shapePicker.defaults={shapes:["circle","square","triangle","x"],pickerDefault:"circle"}})(jQuery);